<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Book a Session</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; }
    form, .slots { max-width: 400px; margin: auto; }
    input, button { display: block; width: 100%; margin: 10px 0; padding: 10px; }
    button { background-color: #28a745; color: white; border: none; cursor: pointer; }
    button:hover { background-color: #218838; }
    .slots { margin-top: 40px; }
    .slot { padding: 5px; margin: 5px 0; border-bottom: 1px solid #ccc; }
  </style>
</head>
<body>

  <h2>Book Your Session</h2>

  <form id="bookingForm">
    <input type="text" id="name" placeholder="Your Name" required />
    <input type="email" id="email" placeholder="Your Email" required />
    <input type="date" id="date" required />
    
    <label for="time">Select Time:</label>
    <select id="time" required>
      <option value="">Choose a time slot</option>
      <!-- Time slots with 15-minute intervals -->
      <option value="09:00">09:00</option>
      <option value="09:15">09:15</option>
      <option value="09:30">09:30</option>
      <option value="09:45">09:45</option>
      <option value="10:00">10:00</option>
      <option value="10:15">10:15</option>
      <option value="10:30">10:30</option>
      <option value="10:45">10:45</option>
      <option value="11:00">11:00</option>
      <option value="11:15">11:15</option>
      <option value="11:30">11:30</option>
      <option value="11:45">11:45</option>
      <!-- Add more slots as needed -->
    </select>

    <button type="submit">Book Now</button>
  </form>

  <p id="status"></p>

  <div class="slots">
    <h3>Booked Slots</h3>
    <button id="loadSlots">Show Booked Slots</button>
    <div id="slotsList"></div>
  </div>

  <script>
    const form = document.getElementById('bookingForm');
    const status = document.getElementById('status');
    const loadSlotsBtn = document.getElementById('loadSlots');
    const slotsList = document.getElementById('slotsList');

    const URL = 'https://script.google.com/macros/s/AKfycbxJudXR8oSEIW3Y-OK46j0zuCHO_5Y0RNfmbBaXPB4ERae-cQL_9KfBO6V0-6DFii-DxA/exec'; // replace with your URL if different

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const data = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        date: document.getElementById('date').value,
        time: document.getElementById('time').value
      };

      status.textContent = "Sending...";

      try {
        await fetch(URL, {
          method: 'POST',
          mode: 'no-cors',  // No need for CORS in POST request
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        status.textContent = "Booking Submitted! Please check your email.";
        form.reset();
      } catch (error) {
        console.error(error);
        status.textContent = "Something went wrong!";
      }
    });

    loadSlotsBtn.addEventListener('click', async () => {
      slotsList.innerHTML = "Loading...";

      try {
        // Make a GET request to fetch the booked slots
        const response = await fetch(URL + "?action=getSlots");

        // Parse the response to get the data
        const bookedSlots = await response.json();

        if (bookedSlots && bookedSlots.length > 0) {
          slotsList.innerHTML = bookedSlots.map(slot => `<div class="slot">${slot.date} at ${slot.time}</div>`).join('');
        } else {
          slotsList.innerHTML = "No slots booked yet.";
        }

      } catch (error) {
        console.error(error);
        slotsList.innerHTML = "Failed to load slots.";
      }
    });
  </script>

</body>
</html>
